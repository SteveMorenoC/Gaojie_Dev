<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Orders - GAOJIE</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="css/order-styles.css">
</head>
<body>
    <!-- Announcement Bar -->
    <div class="announcement-bar">
        <div class="announcement-content">
            <span class="announcement-text">Free shipping in Thailand on orders over ฿999</span>
        </div>
    </div>

    <!-- Main Header -->
    <header class="header">
        <div class="header-container">
            <!-- Logo -->
            <div class="logo">
                <a href="/" class="logo-link">GAOJIE</a>
            </div>

            <!-- Mobile Menu Toggle -->
            <button id="mobile-menu-toggle" class="mobile-menu-toggle" aria-label="Toggle menu">
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
                <span class="hamburger-line"></span>
            </button>

            <!-- Navigation -->
            <nav class="nav" id="main-nav">
                <ul class="nav-list">
                    <li class="nav-item">
                        <a href="/cleanser" class="nav-link">Cleanser</a>
                    </li>
                    <li class="nav-item">
                        <a href="/moisturiser" class="nav-link">Moisturiser</a>
                    </li>
                    <li class="nav-item dropdown">
                        <a href="/treatments" class="nav-link dropdown-toggle">
                            Treatments
                            <svg class="dropdown-icon" width="12" height="8" viewBox="0 0 12 8" fill="none">
                                <path d="M1 1.5L6 6.5L11 1.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </a>
                    </li>
                    <li class="nav-item">
                        <a href="/lip-care" class="nav-link">Lip Care</a>
                    </li>
                    <li class="nav-item">
                        <a href="/sets" class="nav-link">Sets</a>
                    </li>
                </ul>
            </nav>

            <!-- Header Actions -->
            <div class="header-actions">
                <!-- Search -->
                <div class="search-container">
                    <form class="search-form" role="search">
                        <input 
                            type="search" 
                            class="search-input" 
                            placeholder="Search..." 
                            aria-label="Search products"
                        >
                        <button type="submit" class="search-btn" aria-label="Submit search">
                            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
                                <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
                                <path d="M15 15L11.5 11.5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                            </svg>
                        </button>
                    </form>
                </div>

                <!-- Shopping Bag -->
                <a href="/cart" class="bag-btn" aria-label="Shopping bag">
                    <svg class="bag-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3.5 7H16.5L15.5 16H4.5L3.5 7Z" stroke="currentColor" stroke-width="1.5" stroke-linejoin="round"/>
                        <path d="M7 7V5C7 3.89543 7.89543 3 9 3H11C12.1046 3 13 3.89543 13 5V7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="bag-count">1</span>
                </a>
                <a href="/influencers" class="nav-link influencer-link">
                    <svg class="influencer-icon" width="16" height="16" viewBox="0 0 24 24" fill="none">
                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="9" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                        <path d="m22 21-3-3m0 0a2 2 0 1 0-2.83-2.83A2 2 0 0 0 19 18Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Influencers
                </a>

                <!-- User Menu -->
                <div class="user-menu" id="user-orders-menu">
                    <button class="user-btn" aria-label="User menu">
                        <span class="user-name">Loading...</span>
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none">
                            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <circle cx="12" cy="7" r="4" stroke="currentColor" stroke-width="2"/>
                        </svg>
                    </button>
                    <div class="user-dropdown" style="display: none;">
                        <a href="user-orders.html" class="dropdown-item">My Orders</a>
                        <a href="#" class="dropdown-item" onclick="handleProfile()">My Profile</a>
                        <span id="admin-link-placeholder"></span>
                        <a href="#" class="dropdown-item" onclick="handleLogout()">Logout</a>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Orders Page Content -->
    <main class="orders-main">
        <div class="orders-container">
            <!-- Page Header -->
            <div class="orders-header">
                <h1 class="orders-title">My Orders</h1>
                <p class="orders-subtitle">Track and manage your GAOJIE purchases</p>
            </div>

            <!-- Orders Tabs -->
            <div class="orders-tabs">
                <button class="orders-tab active" data-tab="all">All</button>
                <button class="orders-tab" data-tab="to-pay">To Pay</button>
                <button class="orders-tab" data-tab="to-ship">To Ship</button>
                <button class="orders-tab" data-tab="to-receive">To Receive</button>
                <button class="orders-tab" data-tab="to-review">To Review</button>
            </div>

            <!-- Search Bar -->
            <div class="orders-search">
                <div class="orders-search-container">
                    <svg class="orders-search-icon" width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <circle cx="9" cy="9" r="8" stroke="currentColor" stroke-width="1.5"/>
                        <path d="m17 17-4.35-4.35" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
                    </svg>
                    <input 
                        type="text" 
                        class="orders-search-input" 
                        placeholder="Search by product name, order ID, or brand"
                        aria-label="Search orders"
                    >
                </div>
            </div>

            <!-- Orders List -->
            <div class="orders-list">
                <!-- Order 1 -->
                <div class="order-card">
                    

                    <div class="order-product">
                        <div class="product-image-container">
                            <img src="https://images.unsplash.com/photo-1571781926291-c477ebfd024b?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" 
                                 alt="Amino-Acid Cleanser" 
                                 class="order-product-image">
                        </div>
                        <div class="order-product-details">
                            <h3 class="order-product-name">Amino-Acid Cleanser</h3>
                            <p class="order-product-variant">150ml - Gentle Daily Formula</p>
                            <div class="order-product-meta">
                                <span class="order-price">฿1,290</span>
                                <span class="order-quantity">Qty: 1</span>
                            </div>
                            <div class="order-features">
                                <span class="feature-tag">30 Days Free Returns</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-actions">
                        <a href="/order-details?id=ORD240715001" class="order-action-btn primary">View Details</a>
                        <button class="order-action-btn secondary">Write Review</button>
                        <button class="order-action-btn secondary">Buy Again</button>
                    </div>
                </div>

                <!-- Order 2 -->
                <div class="order-card">
                    <div class="order-header">
                       
                        <span class="order-status processing">Processing</span>
                    </div>

                    <div class="order-product">
                        <div class="product-image-container">
                            <img src="https://images.unsplash.com/photo-1556228453-efd6c1ff04f6?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" 
                                 alt="Hydrating Moisturiser" 
                                 class="order-product-image">
                        </div>
                        <div class="order-product-details">
                            <h3 class="order-product-name">Hydrating Moisturiser</h3>
                            <p class="order-product-variant">50ml - 24-Hour Moisture Formula</p>
                            <div class="order-product-meta">
                                <span class="order-price">฿1,590</span>
                                <span class="order-quantity">Qty: 1</span>
                            </div>
                            <div class="order-features">
                                <span class="feature-tag">Free Returns</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-actions">
                        <a href="/order-details?id=ORD240728002" class="order-action-btn primary">Track Package</a>
                        <button class="order-action-btn secondary">Contact Support</button>
                    </div>
                </div>

                <!-- Order 3 - Multiple Items -->
                <div class="order-card">
                    <div class="order-header">
                       
                        <span class="order-status delivered">Delivered</span>
                    </div>

                    <div class="order-product">
                        <div class="product-image-container">
                            <img src="https://images.unsplash.com/photo-1598440947619-2c35fc9aa908?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" 
                                 alt="Complete Skincare Set" 
                                 class="order-product-image">
                        </div>
                        <div class="order-product-details">
                            <h3 class="order-product-name">Complete Skincare Set</h3>
                            <p class="order-product-variant">Cleanser + Moisturiser + Vitamin C Serum</p>
                            <div class="order-product-meta">
                                <span class="order-price">฿3,590</span>
                                <span class="order-quantity">3 items</span>
                            </div>
                            <div class="order-features">
                                <span class="feature-tag">Bundle Discount</span>
                                <span class="feature-tag">Free Shipping</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-actions">
                        <a href="/order-details?id=ORD240720003" class="order-action-btn primary">View Details</a>
                        <button class="order-action-btn secondary">Review Products</button>
                        <button class="order-action-btn secondary">Reorder Set</button>
                    </div>
                </div>

                <!-- Order 4 - Payment Pending -->
                <div class="order-card">
                    <div class="order-header">
                        
                        <span class="order-status pending">Payment Pending</span>
                    </div>

                    <div class="order-product">
                        <div class="product-image-container">
                            <img src="https://images.unsplash.com/photo-1620916566398-39f1143ab7be?ixlib=rb-4.0.3&auto=format&fit=crop&w=200&q=80" 
                                 alt="Retinol Renewal Serum" 
                                 class="order-product-image">
                        </div>
                        <div class="order-product-details">
                            <h3 class="order-product-name">Retinol Renewal Serum</h3>
                            <p class="order-product-variant">30ml - Advanced Anti-Aging Treatment</p>
                            <div class="order-product-meta">
                                <span class="order-price">฿2,190</span>
                                <span class="order-quantity">Qty: 1</span>
                            </div>
                            <div class="order-features">
                                <span class="feature-tag urgent">Payment Due in 2 days</span>
                            </div>
                        </div>
                    </div>

                    <div class="order-actions">
                        <button class="order-action-btn primary urgent">Complete Payment</button>
                        <a href="/order-details?id=ORD240728004" class="order-action-btn secondary">View Details</a>
                    </div>
                </div>
            </div>

            <!-- Empty State (hidden by default) -->
            <div class="orders-empty" style="display: none;">
                <div class="empty-illustration">
                    <svg width="120" height="120" viewBox="0 0 120 120" fill="none">
                        <circle cx="60" cy="60" r="50" stroke="#E5E7EB" stroke-width="2" stroke-dasharray="8 8"/>
                        <path d="M40 60L55 75L80 45" stroke="#9CA3AF" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                </div>
                <h3 class="empty-title">No orders found</h3>
                <p class="empty-description">Start shopping to see your orders here</p>
                <a href="/" class="empty-cta">Continue Shopping</a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <!-- Footer Main Content -->
            <div class="footer-main">
                <!-- Brand Section -->
                <div class="footer-brand">
                    <div class="footer-logo">
                        <h3 class="footer-logo-text">GAOJIE</h3>
                    </div>
                    <p class="footer-description">
                        Premium skincare crafted with clinically proven ingredients and scientific innovation for radiant, healthy skin.
                    </p>
                    <div class="footer-social">
                        <a href="#" class="social-link" aria-label="Instagram">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
                            </svg>
                        </a>
                        <a href="#" class="social-link" aria-label="TikTok">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"/>
                            </svg>
                        </a>
                        <a href="#" class="social-link" aria-label="Facebook">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <!-- Collections -->
                <div class="footer-column">
                    <h4 class="footer-column-title">Collections</h4>
                    <ul class="footer-links">
                        <li><a href="/cleanser" class="footer-link">Cleansers</a></li>
                        <li><a href="/moisturiser" class="footer-link">Moisturisers</a></li>
                        <li><a href="/treatments" class="footer-link">Treatments</a></li>
                        <li><a href="/lip-care" class="footer-link">Lip Care</a></li>
                        <li><a href="/sets" class="footer-link">Sets & Bundles</a></li>
                        <li><a href="/travel" class="footer-link">Travel Size</a></li>
                    </ul>
                </div>

                <!-- Company -->
                <div class="footer-column">
                    <h4 class="footer-column-title">Company</h4>
                    <ul class="footer-links">
                        <li><a href="/about" class="footer-link">About Us</a></li>
                        <li><a href="/science" class="footer-link">Our Science</a></li>
                        <li><a href="/ingredients" class="footer-link">Ingredients</a></li>
                        <li><a href="/sustainability" class="footer-link">Sustainability</a></li>
                        <li><a href="/reviews" class="footer-link">Reviews</a></li>
                        <li><a href="/blog" class="footer-link">Skincare Blog</a></li>
                    </ul>
                </div>

                <!-- Support -->
                <div class="footer-column">
                    <h4 class="footer-column-title">Support</h4>
                    <ul class="footer-links">
                        <li><a href="/contact" class="footer-link">Contact Us</a></li>
                        <li><a href="/faq" class="footer-link">FAQ</a></li>
                        <li><a href="/shipping" class="footer-link">Shipping Info</a></li>
                        <li><a href="/returns" class="footer-link">Returns</a></li>
                        <li><a href="/skincare-quiz" class="footer-link">Skincare Quiz</a></li>
                        <li><a href="/track-order" class="footer-link">Track Order</a></li>
                    </ul>
                </div>

                <!-- Newsletter -->
                <div class="footer-newsletter">
                    <span class="newsletter-incentive">Get 15% Off First Order</span>
                    <h4 class="footer-column-title">Join Our Skincare Community</h4>
                    <p class="newsletter-description">Be the first to know about new launches, exclusive offers, and expert skincare tips.</p>
                    
                    <ul class="newsletter-benefits">
                        <li>Exclusive early access to new products</li>
                        <li>Personalized skincare tips & routines</li>
                        <li>Members-only discounts & promotions</li>
                        <li>Free skincare consultation offers</li>
                    </ul>
                    
                    <div class="newsletter-form">
                        <input type="email" class="newsletter-input" placeholder="Enter your email for 15% off" aria-label="Email address">
                        <button type="submit" class="newsletter-button">Get My 15% Discount</button>
                    </div>
                    <p class="newsletter-disclaimer">
                        By subscribing, you agree to our <a href="/privacy" class="disclaimer-link">Privacy Policy</a>. Unsubscribe anytime.
                    </p>
                </div>
            </div>

            <!-- Footer Bottom -->
            <div class="footer-bottom">
                <div class="footer-bottom-content">
                    <p class="footer-copyright">© 2025 GAOJIE. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="gaojie-common.js"></script>
    <script src="JS/order-styles.js"></script>
    <script>
        // Initialize user menu on orders page
        document.addEventListener('DOMContentLoaded', async function() {
            console.log('User Orders page loaded, initializing user menu');
            
            try {
                // Check auth status
                const response = await fetch('/api/auth/check', { 
                    credentials: 'include' 
                });
                const data = await response.json();
                
                if (data.status === 'success' && data.authenticated && data.user) {
                    console.log('User authenticated, updating user menu');
                    
                    // Update user name in menu
                    const userNameEl = document.querySelector('#user-orders-menu .user-name');
                    if (userNameEl) {
                        userNameEl.textContent = `Hi, ${data.user.first_name}`;
                    }
                    
                    // Add admin link if user is admin
                    if (data.user.is_admin) {
                        const adminPlaceholder = document.getElementById('admin-link-placeholder');
                        if (adminPlaceholder) {
                            adminPlaceholder.innerHTML = '<a href="/admin" class="dropdown-item">Admin Dashboard</a>';
                        }
                    }
                    
                    // Add dropdown functionality
                    const userBtn = document.querySelector('#user-orders-menu .user-btn');
                    const dropdown = document.querySelector('#user-orders-menu .user-dropdown');
                    
                    if (userBtn && dropdown) {
                        userBtn.addEventListener('click', (e) => {
                            e.preventDefault();
                            dropdown.style.display = dropdown.style.display === 'none' ? 'block' : 'none';
                        });
                        
                        // Close dropdown when clicking outside
                        document.addEventListener('click', (e) => {
                            if (!e.target.closest('#user-orders-menu')) {
                                dropdown.style.display = 'none';
                            }
                        });
                    }
                } else {
                    console.log('User not authenticated, redirecting to login');
                    // Redirect to login if not authenticated
                    window.location.href = 'login.html';
                }
            } catch (error) {
                console.error('Auth check failed:', error);
                // Redirect to login on error
                window.location.href = 'login.html';
            }
        });

        // Handle profile function
        window.handleProfile = function() {
            if (window.GaojieUtils && GaojieUtils.showNotification) {
                GaojieUtils.showNotification('Profile page coming soon!', 'info');
            } else {
                alert('Profile page coming soon!');
            }
        };

        // Handle logout function
        window.handleLogout = async function() {
            try {
                const response = await fetch('/api/auth/logout', {
                    method: 'POST',
                    credentials: 'include'
                });
                const data = await response.json();
                
                // Show success message
                if (window.GaojieUtils && GaojieUtils.showNotification) {
                    GaojieUtils.showNotification('Logged out successfully', 'success');
                }
                
                // Redirect to login page
                setTimeout(() => {
                    window.location.href = 'login.html';
                }, 1000);
                
            } catch (error) {
                console.error('Logout failed:', error);
                if (window.GaojieUtils && GaojieUtils.showNotification) {
                    GaojieUtils.showNotification('Logout failed', 'error');
                }
            }
        };
    </script>
</body>
</html>